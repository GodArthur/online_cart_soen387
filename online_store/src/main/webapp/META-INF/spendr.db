-- SQLite does not support dropping databases or creating them with SQL commands.
-- A new database is created by simply connecting to a file.

-- Users Table
CREATE TABLE IF NOT EXISTS USERS (
    user_id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL,
    password TEXT NOT NULL,
    firstname TEXT NOT NULL,
    lastname TEXT NOT NULL,
    is_staff INTEGER NOT NULL -- SQLite uses INTEGER for boolean values (0 = false, 1 = true)
);

-- Products Table
CREATE TABLE IF NOT EXISTS PRODUCTS (
    name TEXT NOT NULL,
    description TEXT,
    vendor TEXT,
    urlSlug TEXT,
    sku TEXT NOT NULL,
    price REAL, -- REAL data type is used for floating point numbers in SQLite
    PRIMARY KEY (name),
    UNIQUE (urlSlug),
    UNIQUE (sku)
);

-- Carts Table
CREATE TABLE IF NOT EXISTS CARTS (
    cart_id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    UNIQUE (user_id),
    FOREIGN KEY (user_id) REFERENCES USERS (user_id)
);

-- Orders Table
CREATE TABLE IF NOT EXISTS ORDERS (
    order_id INTEGER PRIMARY KEY AUTOINCREMENT,
    shipping_address TEXT NOT NULL,
    tracking_number TEXT,
    user_id INTEGER NOT NULL,
    isShipped INTEGER, -- INTEGER is used for boolean values in SQLite
    FOREIGN KEY (user_id) REFERENCES USERS (user_id)
);

-- Order Items Table
CREATE TABLE IF NOT EXISTS ORDER_ITEMS (
    sku TEXT NOT NULL,
    order_id INTEGER NOT NULL,
    quantity INTEGER NOT NULL,
    PRIMARY KEY (sku, order_id),
    FOREIGN KEY (sku) REFERENCES PRODUCTS (sku),
    FOREIGN KEY (order_id) REFERENCES ORDERS (order_id)
);

-- Cart Items Table
CREATE TABLE IF NOT EXISTS CART_ITEMS (
    sku TEXT NOT NULL,
    cart_id INTEGER NOT NULL,
    quantity INTEGER NOT NULL DEFAULT 1,
    PRIMARY KEY (sku, cart_id),
    FOREIGN KEY (sku) REFERENCES PRODUCTS (sku),
    FOREIGN KEY (cart_id) REFERENCES CARTS (cart_id)
);

-- Enable Foreign Key Constraint
PRAGMA foreign_keys = ON;

-- Inserting 5 users
INSERT INTO USERS (username, password, firstname, lastname, is_staff) VALUES
('john_doe', 'securepassword123', 'John', 'Doe', 0),
('jane_smith', 'securepassword123', 'Jane', 'Smith', 0),
('alice_jones', 'securepassword123', 'Alice', 'Jones', 1),
('bob_brown', 'securepassword123', 'Bob', 'Brown', 1),
('charlie_black', 'securepassword123', 'Charlie', 'Black', 0);

-- Inserting 10 products
INSERT INTO PRODUCTS (name, description, vendor, urlSlug, sku, price) VALUES
('Laptop Pro 15"', 'High-performance professional laptop with 15-inch display.', 'TechCorp', 'laptop-pro-15', 'LP1501', 1599.99),
('Smartphone X12', 'Latest X12 smartphone with 6.5-inch screen and 128GB storage.', 'SmartTech', 'smartphone-x12', 'SX1202', 999.99),
('Bluetooth Headphones', 'Wireless Bluetooth headphones with noise-cancellation.', 'SoundMax', 'bluetooth-headphones', 'BH1003', 199.99),
('E-Reader ReadLight', 'E-reader with paper-like display and backlight.', 'ReadTech', 'e-reader-readlight', 'ERL4004', 129.99),
('Smartwatch Fitness Pro', 'Fitness-oriented smartwatch with heart-rate monitor.', 'HealthGear', 'smartwatch-fitness-pro', 'SFP5005', 299.99),
('Portable Charger 10k', 'Portable charger with 10,000mAh capacity.', 'ChargePlus', 'portable-charger-10k', 'PC10006', 49.99),
('Gaming Console PlayMax', 'Next-gen gaming console with 4K resolution support.', 'GameWorld', 'gaming-console-playmax', 'GCP7007', 499.99),
('Wireless Earbuds', 'Compact and waterproof wireless earbuds.', 'SoundMax', 'wireless-earbuds', 'WEB8008', 149.99),
('Action Camera Xtreme', '4K action camera with waterproof casing and stabilization.', 'CamTech', 'action-camera-xtreme', 'ACX9009', 249.99),
('Smart Home Speaker', 'Voice-controlled smart speaker with home automation features.', 'SmartHome', 'smart-home-speaker', 'SHS1010', 129.99);

-- Inserting carts for each user
-- Assuming the USERS table has auto-incremented user_id from 1 to 5
INSERT INTO CARTS (user_id) VALUES
(1),
(2),
(3),
(4),
(5);

-- Inserting orders for each user
-- Assuming the ORDERS table will auto-increment order_id starting from 1
INSERT INTO ORDERS (shipping_address, tracking_number, user_id) VALUES
('123 Main St, Anytown, USA', 'TRACK001', 1),
('456 Elm St, Othertown, USA', 'TRACK002', 2),
('789 Oak St, Anycity, USA', 'TRACK003', 3),
('101 Pine St, Othercity, USA', 'TRACK004', 4),
('202 Maple St, Somewhere, USA', 'TRACK005', 5);

-- Inserting cart items for each user
-- Each user has 2 products in their cart
INSERT INTO CART_ITEMS (sku, cart_id, quantity) VALUES
('LP1501', 1, 1),
('SX1202', 1, 1),
('BH1003', 2, 1),
('ERL4004', 2, 1),
('SFP5005', 3, 1),
('PC10006', 3, 1),
('GCP7007', 4, 1),
('WEB8008', 4, 1),
('ACX9009', 5, 1),
('SHS1010', 5, 1);
